<!DOCTYPE html>
<html lang="en">
<head>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="manifest" href="/manifest.json">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial scale=1.0">
    <link rel="icon" type="image/png" href="img/opened-book-icon.png">
    <title> PWA alkalamaz√°s</title>
</head>
<body style="background-color: rgb(218, 213, 213);">
    <h1>Search for books</h1>
    <input type="text" id="search" placeholder="search" size="width=device-width" style="float: left">
    <button id="searchButton">Search</button>
    <div id="searchResults"></div>
    <script>
      function search(query){
        const apiUrl = `https://openlibrary.org/search.json?q=${query}`;

        fetch(apiUrl)
          .then(response => response.json())
          .then(data=> {
            document.getElementById("searchResults").innerHTML="";
            const results = data.docs;
            results.forEach(book => {
              const title = book.title;
              const author = book.author_name ? book.author_name.join(', ') : "Unknown";
              const year = book.publish_year ? book.publish_year[0] : "Unknown";
              const coverId = book.cover_i ? book.cover_i:null
              const coverUrl = coverId ? `https://covers.openlibrary.org/b/id/${coverId}-L.jpg` : "No cover available";
              const result = `
                <div>
                  <strong>Title:</strong> ${title}<br>
                  <strong>Author(s):</strong> ${author}<br>
                  <strong>Year:</strong> ${year}<br>
                  <img src="${coverUrl}" alt="No cover" style = "max-width: 50 px;">
                </div><br>`;
              document.getElementById("searchResults").innerHTML += result;
            });
          })
          .catch(error => {
            console.error(error);
          });
      }
      document.getElementById("searchButton").addEventListener("click", function(){
        const query = document.getElementById("search").value.trim();
        if (query !== ""){
          search(query);
        } else{
          alert("Please enter a search query.");
        }
      });
    </script>
    

</body>
</html>